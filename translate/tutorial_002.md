<!-- translate/tutorial_002.md -->

## 2. Pythonインタプリタを使ってみよう

### 2.1. インタプリタの起動方法

Pythonインタプリタは、利用可能なマシンでは通常 `/usr/local/bin/python3.9` という場所にインストールされています。お使いのUnixシェルの検索パスに `/usr/local/bin` を追加しておけば、シェルで次のようにコマンドを打ち込むだけで起動できます。

```bash
python3.9
```

ただし、インタプリタがどこにインストールされるかは選択可能なので、他の場所にある可能性もあります。あなたの周りにいるPythonの達人やシステム管理者に確認してみてください（例えば、`/usr/local/python` もよく使われる場所です）。

Microsoft StoreからPythonをインストールしたWindowsマシンでは、`python3.9` コマンドが利用できます。もし `py.exe` ランチャーをインストールしている場合は、`py` コマンドを使うこともできます。Pythonを起動する他の方法については、「補足：環境変数の設定」を参照してください。

プライマリプロンプト（`>>>` のこと）が表示されている状態で、ファイル終端文字（Unixでは `Control-D`、Windowsでは `Control-Z`）を入力すると、インタプリタは終了ステータス0で正常に終了します。もしそれで終了しない場合は、`quit()` というコマンドを入力して終了することもできます。

インタプリタの行編集機能には、対話的な編集、履歴の呼び出し、コード補完などがあり、これらはGNU Readlineライブラリをサポートしているシステムで利用できます。コマンドライン編集がサポートされているかどうかを一番手っ取り早く確認する方法は、最初に表示されるPythonプロンプトで `Control-P` を押してみることです。もしビープ音が鳴れば、コマンドライン編集が使えます。キー操作の入門については、付録の「対話的な入力編集と履歴置換」を参照してください。もし何も起こらなかったり、`^P` と表示されたりした場合は、コマンドライン編集は利用できません。その場合、現在の行から文字を削除するにはバックスペースキーしか使えません。

インタプリタの動作は、Unixシェルに少し似ています。標準入力が端末（ttyデバイス）に接続されている状態で呼び出されると、コマンドを対話的に読み込んで実行します。ファイル名を引数として指定したり、ファイルを標準入力として渡したりして呼び出されると、そのファイルからスクリプトを読み込んで実行します。

インタプリタを起動するもう一つの方法は `python -c command [arg] ...` です。これはシェルの `-c` オプションと同じように、`command` に書かれた文を実行します。Pythonの文には、スペースやシェルにとって特別な意味を持つ文字が含まれていることが多いため、`command` 全体をシングルクォートで囲むのが一般的です。

いくつかのPythonモジュールは、スクリプトとしても役立ちます。これらは `python -m module [arg] ...` のようにして呼び出すことができ、あたかもコマンドラインでモジュールのフルネームを指定したかのように、そのモジュールのソースファイルを実行します。

スクリプトファイルを使うとき、スクリプトを実行した後にそのまま対話モードに入りたい場合があります。これは、スクリプトの前に `-i` を付けることで実現できます。

すべてのコマンドラインオプションについては、「コマンドラインと環境」で説明されています。

#### 2.1.1. 引数の受け渡し

インタプリタに渡されたスクリプト名とそれに続く追加の引数は、文字列のリストに変換され、`sys` モジュールの `argv` という変数に代入されます。このリストには `import sys` を実行することでアクセスできます。リストの長さは少なくとも1です。スクリプトも引数も指定されなかった場合、`sys.argv[0]` は空の文字列になります。スクリプト名として `-`（標準入力を意味します）が指定された場合、`sys.argv[0]` は `'-'` に設定されます。`-c command` が使われた場合、`sys.argv[0]` は `'-c'` に設定されます。`-m module` が使われた場合、`sys.argv[0]` は見つかったモジュールのフルネームに設定されます。`-c command` や `-m module` の後にあるオプションは、Pythonインタプリタのオプション処理では消費されず、コマンドやモジュールが処理できるように `sys.argv` に残されます。

#### 2.1.2. 対話モード

コマンドが端末（tty）から読み込まれるとき、インタプリタは「対話モード」にあると言います。このモードでは、次のコマンドを促すためにプライマリプロンプト、通常は3つの「より大きい」記号（`>>>`）を表示します。複数行にわたる入力を続けるための継続行では、セカナリプロンプト、デフォルトでは3つのドット（`...`）を表示します。インタプリタは、最初のプロンプトを表示する前に、バージョン番号と著作権表示を含むウェルカムメッセージを表示します。

```
$ python3.9
Python 3.9 (default, June 4 2019, 09:25:04)
[GCC 4.8.2] on linux
Type "help", "copyright", "credits" or "license" for more information.
>>>
```

複数行にわたる構文を入力するときは、継続行が必要になります。例として、この `if` 文を見てみましょう。

```python
>>> the_world_is_flat = True
>>> if the_world_is_flat:
...     print("Be careful not to fall off!")
...
Be careful not to fall off!
```

対話モードについてさらに詳しく知りたい場合は、「対話モード」のセクションを参照してください。

### 2.2. インタプリタとその環境

#### 2.2.1. ソースコードのエンコーディング

デフォルトでは、PythonのソースファイルはUTF-8でエンコードされているものとして扱われます。このエンコーディングでは、世界中のほとんどの言語の文字を、文字列リテラル、識別子（変数名など）、コメントの中で同時に使用できます。ただし、標準ライブラリでは識別子にASCII文字しか使用しておらず、これは移植性の高いコードが従うべき慣習です。これらの文字をすべて正しく表示するには、お使いのエディタがファイルをUTF-8として認識し、ファイル内のすべての文字をサポートするフォントを使用する必要があります。

デフォルト以外のエンコーディングを宣言するには、ファイルの最初の行に特別なコメント行を追加する必要があります。構文は次のとおりです。

```python
# -*- coding: encoding -*-
```

ここで `encoding` は、Pythonがサポートする有効なコーデックの一つです。

例えば、Windows-1252エンコーディングを使用することを宣言するには、ソースコードファイルの最初の行を次のようにします。

```python
# -*- coding: cp1252 -*-
```

この「最初の行」ルールには一つ例外があります。それは、ソースコードがUNIXの「シバン（shebang）」行で始まる場合です。その場合、エンコーディングの宣言はファイルの2行目に追加する必要があります。例えば、次のようになります。

```python
#!/usr/bin/env python3
# -*- coding: cp1252 -*-
```

---
**脚注**

<sup>1</sup> Unixでは、Python 3系のインタプリタは、デフォルトでは `python` という名前の実行可能ファイルとしてはインストールされません。これは、同時にインストールされている可能性のあるPython 2系の実行可能ファイルと衝突しないようにするためです。